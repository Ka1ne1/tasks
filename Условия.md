# Условия

# Задание 1
На каком порту работает протокол UDP?
# Ответ на вопрос
Краткий ответ: **на любом**, _но 0 порт зарезервирован_.

Полный ответ: 
Порты являются логическими конструктами, определяющими процесс/службу, которой предназначается передаваемый пакет, т.е. мультиплексором для служб/процессов, разделяющих один сетевой адрес. Согласно RFC 768 (https://tools.ietf.org/html/rfc768), протокол UDP работает поверх протокола IP и отвечает за доставку пакетов по адресу IP с указанием в заголовке порта процесса, которому предназначен пакет. Таким образом, значение поля порта получателя имеет значение только при обработке полученного пакета получателем и при прохождении сетевого оборудования с настроенными списками контроля доступа.

Однако, согласно всё тому же RFC 768, значение порта 0 вставляется в поле порта отправителя, если оно не используется отправителем. Да и согласно перечню IANA (использование портов регулируется IANA - https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml), 0 порт зарезервирован (но в теории это не мешает нам "слушать" этот порт или отправлять на него пакеты). Все порты разделены на три диапазона — общеизвестные (или системные, 0—1023), зарегистрированные (или пользовательские, 1024—49151) и динамические (или частные, 49152—65535). Эта информация важна для избежания ситуации, когда возникает конфликт между процессами и службами, пытающимися слушать один и тот же порт.

# Задание 2
По вашему мнению, какие "нашумевшие" атаки больше всего угрожали финансовым организациям? Какие промышленным? Ответ поясните.
# Ответ на вопрос
Финансовым учреждениям больше всего угрожают атаки, связанные с выводом денег через SWIFT, АРМ КБР, карточный процессинг и банкоматы. Примерами таких атак могут служить Carbanak, Cobalt, Silence, атаки группировки Lazarus, MoneyTaker. 
Промышленным учреждениям больше всего угрожают атаки, связанные с шпионажем и саботажем производства. Примерами могут служить такие атаки, как Crouching Yeti, Equation, GreyEnergy. Особо отмечу BlackEnergy, так как эта атака опасна практически для всех организаций, использующих системы ICS/SCADA. Одним из последствий этой атаки являлось обесточивание на несколько часов электрических подстанций в областях Украины.
Также не могу обойти стороной шифровальщиков WannaCry, NotPetya, BadRabbit. Как показала история, от таких атак пострадали больше промышленные организации (в фин. учреждениях также были зафиксированы единичные факты компрометации ресурсов, однако последствия устранили в кратчайшие сроки). Работа IT-систем многих организаций (Moller-Maersk, «Роснефть», Renault, Deutsche Bahn и т.д.) были восстановлены только через несколько дней после атаки, а ущерб оценивается в сотни млн. долларов.

# Задание 3
Предположим, что существует компания **Singen**. К сожалению, в последнее время она сильно страдает от спамерских рассылок, которые злоумышленники делают от её имени добропорядочным людям (клиентам).
Компании принадлежат известные домены singen.ru и the-hound.ru. Её сотрудники исполняя свои обязанности пишут письма с доменов @singen.ru и @support.singen.ru.

Каким образом необходимо сконфигурировать доменную зону, чтобы злоумышленники больше не могли посылать письма от имени представительства компании?

(для решения этого задания необходимо понять назначение **SPF**, **DKIM** и **DMARC**)
# Ответ на вопрос
## Оговорки

В задании спрашивается про конфигурирование доменной зоны, поэтому следует указать записи для DNS сервера. Дополнительные пояснения могли принести +1 бал в том или ином случае.

В целом, данное решение призвано не только указать, как правильно нужно было отвечать на вопрос, но и также решение сделано ради образовательной цели, чтобы максимально пояснить несколько ИБ-нюансов.

(*я буду использовать синтаксис задания доменной зоны аналогичный тому, который используется в небеизвестном DNS-сервере bind9, но это было совсем не обязательно для успешного решения задания*)
(*в целом, оценка складывалась из -1 баллов, если не были указаны явно зоны, для которых нужно назначить ту или иную запись, или если запись была не правильной, также давались +1 баллы, если были дополнительно указаны некоторые аспекты, которые описаны в конце writeup*)

## Таки решение

Обратите внимание, что Заказчик жалуется, что от его имени шлют поддельные письма в другие Компании, поэтому здесь не может идти речи о том, чтобы захарденить свой антиспам фильтр, он тут вообще ни при делах и поддельных писем не видет.

Отметим, что всего даны 3 доменных зоны, о которых не следует забывать:

```
singen.ru
support.singen.ru
the-hound.ru
```

Чтобы дальнейшие пояснения были более понятными, укажем импровизированные параметры в настройках DNS нашего заказчика:

```
singen.ru           IN MX 10    mail
support.singen.ru   IN MX 10    mail
mail                IN A        1.2.3.4
mail                IN A        6.7.8.9
```

1. Внедрение SPF записи.

    SPF является DNS записью вида TXT для домена example.com и позволяет задать, с каких IP-адресов могут быть отправлены письма от имени домена (i.ivanov@example.com), на котором размещена SPF запись.

    Особенности:

    1. *Миссия SPF*: SPF позволяет связать домен и IP-адрес (единственная известная информация о письме изначально), чтобы использовать репутацию и другие спам и фишинг метрики для данного домена. 

        Домен берётся из содержимого поля `MAIL TO:`, которое не является частью тела письма (не тоже самое, что и `To:` в заголовках письма)

    1. SPF НЕ распространяется на поддомены
    1. Для ВСЕХ доменов (в частности для the-hound), которые ассоциируются и используются Заказчиком, необходимо настроить SPF запись, потому что фишинг можно провести и от имени домена, который люди ассоциируют с Заказчиком, несмотря на то, что для отправки писем от сотрудников, он может и не используется.
    1. директива `-all` (отбрасывает письмо сразу, если проверка не пройдена) - крайне желательна, если сделать `~all` (помечает письмо, если проверка не пройдена), то дальше фильтрация письма остаётся на откуп антиспам фильтра, который у других Компаний (тех кому послали письмо от имени Singen) ещё не ясно нормально ли настроен. Таким образом, `-all` позволяет жёстко контролировать поддельные письма, даже если у других компаний всё плохо с их антиспамом, ...

    ```
    singen.ru           IN TXT ("v=spf1 +mx ip4:6.5.4.3 -all")
    support.singen.ru   IN TXT ("v=spf1 +mx ip4:6.5.4.3 -all")
    the-hound.ru        IN TXT ("v=spf1 -all")                  ; Здесь мы обязательно запретим отправку почту от имени домена the-hound.ru
    ```

    Заметим, что в SPF не ясно зачем указывать директиву "+a", т.к. A записи DNS - это какие-то сайты, и с их IP-адресов почту не посылают, зато с MX серверов почту могут посылать, поэтому добавление "+mx" имеет смысл, и конечно IP-адреса, с которых корпоративные mail сервера отсылают почту.

1. Внедрение DKIM записи.
    
    DKIM является DNS записью вида TXT для домена example.com и позволяет задать публичный ключ, с помощью которого можно проверить цифровую подпись для писем, в которых эта подпись имеется (совсем не обязательно эта подпись должна присутствовать).

    Особенности:

    1. *Миссия DKIM*: подтвердить, что письмо, прошло через mail-сервера Заказчика, с использованием ассиметричной криптографии.
    1. DKIM распространяется на поддомены, если только вы не добавили директиву `t=s`, которая отменяет свойство распространения DKIM подписи на поддомены, и тогда её нужно указывать для всех используемых доменов и поддоменов.
    1. Чтобы увидеть DKIM в реальности - достаточно послать письмо самому себе на каком-нибудь известном почтовике (например, yandex или google)
    1. Отметим, что селектор (в примере ниже - `gomail`) - может быть любым, так как он отдельно указывается в DKIM подписи, которая прикрепляется к письму
    1. Стоит отметить, что самый распространённый вариант - использовать 1024 битный не совсем верный, т.к. 1024-битная криптография уже не считается достаточно безопасной. Лучше использовать 2048 битный ключ.

    ```
    gomail._domainkey.singen.ru           IN TXT ("v=DKIM1; k=rsa; t=s; p=BASE64;")
    gomail._domainkey.support.singen.ru   IN TXT ("v=DKIM1; k=rsa; t=s; p=BASE64;")
    ```

    Пример DKIM:

    ```
    DKIM-Filter: OpenDKIM Filter v2.11.0 mail.singen.ru 166FE4045C
    DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=singen.ru; s=gomail;
        t=1552744413; bh=ciypVZu58x8JkQOvE7Vs8/0v5SIDHKKfcYJpKV+Oj94=;
        h=From:To:Subject:Date:From;
        b=RPHsrbBKH54bAxz77h3yYPsaIqLM30hbrjqa1uyZ/ZIMkwypR2rFMZEVAvKrqId6D
         BNZ5Kx5oSGAvy1/zVhPcidNrKcGfkKswVnlyvc1+GC7D4GtaLz47DXjVsoM6oKCZtJ
         2tTeRirVbWjmtVYC61zPtt33jXVuXPo/quJEIRUU=
    ```

    Смягчение внедрения:

    1. использовать инструкцию `t=y;`, чтобы отслеживать результаты.

    Недостатки DKIM:

    1. Никак не регламентируется связь между доменными именами, которые используются в письме (в адресах отправителя) и доменом, который указан в DKIM подписи. По сути, подпись вообще может быть на чужой домен.
    1. Никак не регламентируется, какие поля подписываются. Таким образом, если раздобыть подпись не для `h=From:To:Subject:Date:From;`, а например для `h=From:Subject;` (а ведь mail-сервер может подписать чути ли ни что угодно своим приватным ключём), то эту подпись злоумышленник сможет использовать для письма с любым содержимым и любом адресом назначения.

1. Внедрение DMARC записи.

    DMARC является DNS записью вида TXT для домена example.com и используется для регламентирования, как письма проверяются на DKIM и SPF и что делать с письмами, если они не прошли проверку.

    Особенности:

    1. *Миссия DMARC*: Письма от компании могут быть посланы самым разным получателям, и не понятно, как у них там настроены антиспам фильтры, ... Поэтому DMARC позволяет жёстко регламентировать для получателей, как проверяется SPF и DKIM и что делать с письмами, если ошибка
    1. DMARC автоматически распространяется на поддомены, поэтому, её как правило можно устанавливать только на верхнеуровневый домен.
    1. Полезно указывать строгую проверку `adkim=s; aspf=s;`, чтобы регламентировать чёткое соответствие между доменами, и запретить отправку почтовых сообщений от поддоменов, если для них неверна SPF или DKIM.
    1. Можно использовать как reject (дроп письма на месте) политику так и quarantine (отправка сообщения в спам).
    1. чтобы мониторить, на сколько сильно фишится компания Singen можно указать адреса типа rua, куда будут посылаться репорты о письмах, которые нарушили политики.

    ```
    _dmarc.singen.ru        IN TXT ("v=DMARC1; p=reject; adkim=s; aspf=s; rua=mailto:postman@singen.ru")
    _dmarc.the-hound.ru     IN TXT ("v=DMARC1; p=reject; adkim=s; aspf=s; rua=mailto:postman@singen.ru")
    ```

    Смягчение внедрения. Если ошибиться с DMARC, то вся исходящая почта домена ляжет (в спам), что недопустимо с точки зрения бизнеса, поэтому можно прибегнуть к следующим мерам

    1. использовать инструкцию `pct=1;`, которая регламентирует применение DMARC только к соответствующему проценту писем. Таким образом ваша почта, не умрёт
    1. обязательно настроить посылку репортов, чтобы мониторить, какие письма нарушают установленные политики (`rua`, `ruf`).

1. Внедрение ADSP

    ADSP запись в DNS вида TXT позволяет регламентировать, что для всех писем отправленных с данного домена обязательно должна присутствовать DKIM.

    Особенности:

    1. устарела, заменена на DKIM
    1. в целом полезно указать ADSP и для домена, от имени которого почта не посылается, чтобы обязать письма иметь DKIM подпись, которой существовать не может, потому что DKIM c публичным ключём не указана.

    ```
    _adsp._domainkey.singen.ru          IN TXT ("dkim=all")
    _adsp._domainkey.support.singen.ru  IN TXT ("dkim=all")
    _adsp._domainkey.the-hound.ru       IN TXT ("dkim=all")
    ```

Подбивая краткий итог:

* IP-адрес с которого было послано письмо связывается с доменом от имени которого письмо посылается (`MAIL FROM:`).
* DKIM связывает домен, который указан в DKIM (`d=singen;`) с реальным владельцем домена (который расположил публичный ключ).
* DMARC регламентирует применение DKIM и SPF.

## Дополнительные баллы

Дополнительно давались (восстанавливались, потерянные на других ошибках) баллы, если:

1. за хорошее теоретическое объяснение (не скопированное из хабра, а написанное самостоятельно с описанием нюансов, которые понял докладчик)
1. объяснялось использование `adkim=s; aspf=s;` для DMARC
1. объяснялось использование `pst=1;` для DMARC
1. объяснялось использование `t=y` и `t=s;` для DKIM
1. говорилось об использовании ADSP

# Задание 4
Представьте, что вы занимаете позицию **CISO** в одном из крупных российских банков. Вам необходимо сформировать бюджет на повышение защищенности компании на следующий год. Из приведенных далее пунктов, на какие мероприятия/солюшны/решения вы бы потратили деньги в первую очередь? Дайте развернутый ответ, аргументирующий выбранный порядок.
1. Построение системы управления информационной безопасностью в соответствии с лучшими практиками ISO 27001
2. Проведение аудита соответствия стандарту PCI DSS
3. Организация команды Red Team для непрерывного внутреннего тестирования
4. Построение процесса управления уязвимиостями (Vulnerability Management)
5. Приведение в соответствие с отраслевыми стандартами (СТО БР ИББС)
6. Проведение комплексного теста на проникновение  

P.S. Считаем, что кроме Вас в Компании больше нет ничего, связанного с обеспечением ИБ  
P.S.S. Вы можете также предложить свои идеи по списку
# Ответ на вопрос
Ответ в файле **ANSWER.pdf** (здесь приведено лучшее решение, хотя ему немного не хватает краткости и нескольких аспектов: GDRP/ФЗ-152/работа с криптографией)

# Задание 5
Написать регулярное выражение для выборки строк из ниже приведённого лога, содержащих следующие сигнатуры атак
(*or*,*1=1*,*script*,*select*,*union*,*alert*,*sleep*). Регулярное выражение должно выводить в групах **ТОЛЬКО** следующую информацию:

* IP (*66.249.65.159*)
* Время и дата (*06/Nov/2014:19:10:38 +0600*)
* Имя параметра (*kekpek*)
* Значения параметра (*53f8d72920ba2744fe873ebc*)

Пример лога:
```
66.249.65.159 - - [06/Nov/2014:19:10:38 +0600] "GET /?kekpek=53f8d72920ba2744fe873ebc HTTP/1.1" 404 177 "-" "Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e Safari/8536.25 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)"
66.249.65.3 - - [06/Nov/2014:19:11:24 +0600] "GET /?q=%E0%A6%AB%E0%A6' or 1=1'%BE%E0%A7%9F%E0%A6%BE%E0%A6%B0 HTTP/1.1" 200 4223 "-" "Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)"
66.249.65.62 - - [06/Nov/2014:19:12:14 +0600] "GET /?q=%E0%A6%A6%E0%A7%8B%<script>alert(1)</script>E0%A7%9F%E0%A6%BE HTTP/1.1" 200 4356 "-" "Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)"
```
# Ответ на вопрос
## Вариант от Павла Шлюндина @Riocool

```
(\d+\.\d+\.\d+\.\d+?) - - \[(.+?)\]\s*\"\w*\s*\/.*?(?=\?)(?:(?:\&|\?)([\w\%]*?)\=(.+?(?:or|1\=1|script|select|union|alert|sleep).+?(?=(?:\?|\&| HTTP))))*
```

## Другой вариант

Для написания регулярных выражений, люблю https://regex101.com

_P.S. Плюс от себя добавил именование групп **?<NAME_GROUP>** в задание это не требуется_

```
/(?<IP>\d+\.\d+\.\d+\.\d+?).*\[(?<DATE>.*)\].*\/\?(?<NAME>.*)=(?<PARAMS>.*(?:or|1=1|script|select|union|alert|sleep).*) HTTP/gmU
```

Если не указать модификатор _**U**_ в группе **IP** будет обрезать до 1 символа, окончание.

# Задание 6
В рамках расследования инцидента мы получили следующую информацию(tcpdump_log,error.log,access.log), опишите какие атаки проводились, какие были успешны или неуспешны?
# Ответ на вопрос
От себя добавлю, что для анализа дампа **tcpdump_log** на Windows (*~~бывает и такое~~*), использовал `Wireshark`.

_P.S. Добро пожаловать на owasp.org_ 

## Огромное спасибо Роману @Romanbullet за ответ:


 Для упрощения исследования данного дампа трафика, воспользуемся утилитой `tshark` и отфильтруем HTTP запросы на WEB-сервер.
 
 ```
 tshark -r ./tcpdump.pcap -Y http -T fields -e http.request.full_uri
 ```
 Далее в ходе углубленного анализа ответов сервера построена таблица, представленная ниже.

Обозначения и сокращения в таблице:
 - XSS - Cross-Site Scripting
 - XXE - eXternal Entity XML
 - LFI - Local File Inclusion
 - !?  - Ответ сервера содержит чувствительную информацию об используемых программных компонентах

```---------------------------------------------------------------------------------------------------------------------------------------------------
 | №  | attack    | attack type          | request                                                                                          | success  |
 |:--:|:---------:|:--------------------:|:------------------------------------------------------------------------------------------------:|:--------:|
 | 1  | No        | -                    | GET /test1/example2.php?name=root HTTP/1.1                                                       |    -     |
 | 2  | Yes       | SQL Injection        | GET /test1/example2.php?name=root%27%20or%20%271%27=%271 HTTP/1.1                                |   No     |
 | 3  | Yes       | SQL Injection        | GET /test1/example2.php?name=root%27/\*\*/and/\*\*/%271%27=%271 HTTP/1.1                         |   No     |
 | 4  | Yes       | SQL Injection        | GET /test1/example2.php?name=root%27/\*\*/or/\*\*/%271%27=%271 HTTP/1.1                          |   Yes    |
 | 5  | No        | -                    | GET / HTTP/1.1                                                                                   |   -      |
 | 6  | Yes       | Path Traversal       | GET /dirtrav/example1.php?file=hacker.png HTTP/1.1                                               |   No     |
 | 7  | Yes       | Path Traversal       | GET /dirtrav/example2.php?file=/var/www/files/hacker.png HTTP/1.1                                |   No     |
 | 8  | Yes       | Path Traversal       | GET /dirtrav/example3.php?file=hacker HTTP/1.1                                                   |   No     |
 | 9  | No        | -                    | GET /test2/example2.php?name=hacker HTTP/1.1                                                     |   -      |
 | 10 | Yes       | XSS                  | GET /test2/example2.php?name=%3Cscript%3Ealert(1)%3C/script%3E HTTP/1.1                          |   No     |
 | 11 | Yes       | XSS                  | GET /test2/example2.php?name=%3CscriPt%3Ealert(1)%3C/script%3E HTTP/1.1                          |   No     |
 | 12 | Yes       | XSS                  | GET /test2/example2.php?name=%3CscriPt%3Ealert(1)%3C/scrIpt%3E HTTP/1.1                          |   Yes    |
 | 13 | No        | -                    | GET / HTTP/1.1                                                                                   |   -      |
 | 14 | Yes       | Path Traversal       | GET /dirtrav/example1.php?file=hacker.png HTTP/1.1                                               |   No     |
 | 15 | Yes       | Path Traversal       | GET /dirtrav/example2.php?file=/var/www/files/hacker.png HTTP/1.1                                |   No     |
 | 16 | Yes       | Path Traversal       | GET /dirtrav/example3.php?file=hacker HTTP/1.1                                                   |   No     |
 | 17 | Yes       | XXE                  | GET /test4/example1.php?xml=%3Ctest%3Ehacker%3C/test%3E HTTP/1.1                                 |   No     |
 | 18 | Yes       | XXE                  | GET /test4/example1.php?xml=%3C!DOCTYPE%20foo%20[%3C!ELEMENT%20foo%20ANY%3E%3C!                  |   !?     |
 |    |           |                      | ENTITY%20xxe%20SYSTEM%20%22file:/etc/passw%22%3E]%3E%3Cfoo%3E&xxe;%3C/foo%3E HTTP/1.1            |          |
 | 19 | No        | -                    | GET / HTTP/1.1                                                                                   |   -      |
 | 20 | Yes       | Path Traversal       | GET /dirtrav/example1.php?file=hacker.png HTTP/1.1                                               |   No     |
 | 21 | Yes       | Path Traversal       | GET /dirtrav/example2.php?file=/var/www/files/hacker.png HTTP/1.1                                |   No     |
 | 22 | Yes       | Path Traversal       | GET /dirtrav/example3.php?file=hacker HTTP/1.1                                                   |   No     |
 | 23 | Yes       | LFI                  | GET /test6/example3.php?file=/etc/passwd HTTP/1.1                                                |   No     |
 | 24 | Yes       | LFI                  | GET /test6/example3.php?file=../../../../../etc/passwd HTTP/1.1                                  |   No     |
 | 25 | Yes       | LFI                  | GET /test6/example3.php?file=../../../../../etc/passwd%00 HTTP/1.1                               |   Yes    |
 | 26 | No        | -                    | GET /test6/example2.php HTTP/1.1                                                                 |   -      |
 | 27 | No        | -                    | GET / HTTP/1.1                                                                                   |   -      |
 | 28 | Yes       | Path Traversal       | GET /dirtrav/example1.php?file=hacker.png HTTP/1.1                                               |   No     |
 | 29 | Yes       | Path Traversal       | GET /dirtrav/example2.php?file=/var/www/files/hacker.png HTTP/1.1                                |   No     |
 | 30 | Yes       | Path Traversal       | GET /dirtrav/example3.php?file=hacker HTTP/1.1                                                   |   No     |
 | 31 | No        | -                    | GET /test5/example1.php?name=hacker HTTP/1.1                                                     |   -      |
 | 32 | No        | -                    | GET /test5/example1.php?name=hacker%22 HTTP/1.1                                                  |   -      |
 | 33 | No        | Command Injection    | GET /test5/example1.php?name=hacker%22.%27uname%20-a%27;%22 HTTP/1.1                             |   No     |
 | 34 | No        | Command Injection    | GET /test5/example1.php?name=hacker%22.(%27uname%20-a%27); HTTP/1.1                              |   !?     |
 | 35 | No        | -                    | GET / HTTP/1.1                                                                                   |   -      |
 | 36 | Yes       | Path Traversal       | GET /dirtrav/example1.php?file=hacker.png HTTP/1.1                                               |   No     |
 | 37 | Yes       | Path Traversal       | GET /dirtrav/example2.php?file=/var/www/files/hacker.png HTTP/1.1                                |   No     |
 | 38 | Yes       | Path Traversal       | GET /dirtrav/example3.php?file=hacker HTTP/1.1                                                   |   No     |
 | 39 | Yes       | LDAP Injection       | GET /test3/example2.php?name=hacker&password=hacker HTTP/1.1                                     |   Yes    |
 | 40 | Yes       | LDAP Injection       | GET /test3/example2.php?name=hacker&password=hacker%27%20or%20%271%27=%271 HTTP/1.1              |   Yes    |
 | 41 | Yes       | LDAP Injection       | GET /test3/example2.php?name=hacker&password=hacker%27%20or%20%271%27=%271%20--%20r HTTP/1.1     |   Yes    |
 | 42 | Yes       | LDAP Injection       | GET /test3/example2.php?name=hacker%27%20or%20%271%27=%271%27%20--%201&password=hacker HTTP/1.1  |   Yes    |
 | 43 | Yes       | LDAP Injection       | GET /test3/example2.php?name=hackerhacker)(cn=*))&password=hacker HTTP/1.1                       |   !?     |
 | 44 | Yes       | LDAP Injection       | GET /test3/example2.php?name=hackerhacker)(cn=*))%00&password=hacker HTTP/1.1                    |   Yes    |
 | 45 | Yes       | LDAP Injection       | GET /test3/example2.php?name=hacker)(cn=*))%00&password=hacker HTTP/1.1                          |   Yes    |
  ```
# Задание 7
При возникновении инцидента информационной безопасности нарушитель повредил накопитель на жестких магнитных дисках. Единственное, что успели специалисты, это сохранить дамп оперативной памяти **«20190227.mem»** на съемный носитель. Во время инцидента у нарушителя на рабочем столе компьютера был открыт очень важный документ c расширением **«.doc»**, восстановите этот документ. (Вы можете использовать утилиты для работы с оперативной памятью и восстановлением файлов, например **volatility**)

*Архив с дампом лежит вот по этой [ссылке](https://mega.nz/#!XQJzza4A!u81-eUyUqjdEIoOw748T-fZF0F94QK4OSoymorLl3zs)*
# Ответ на вопрос
## Огромное спасибо Роману @Romanbullet 

Ответ Романа в файле **ANSWER1.pdf**


## Небольшой оффтоп от~~для~~ себя

Как и у Романа, мой выбор пал на **Ubuntu**

* ```apt install volatility```
* Узнаем версию ОС ```volatility -f 20190227.mem imageinfo```:
```
Volatility Foundation Volatility Framework 2.6
INFO    : volatility.debug    : Determining profile based on KDBG search...
          Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86)
                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)
                     AS Layer2 : FileAddressSpace (/root/20190227.mem)
                      PAE type : PAE
                           DTB : 0x334000L
                          KDBG : 0x8054c2e0L
          Number of Processors : 1
     Image Type (Service Pack) : 2
                KPCR for CPU 0 : 0xffdff000L
             KUSER_SHARED_DATA : 0xffdf0000L
           Image date and time : 2019-02-27 13:33:47 UTC+0000
     Image local date and time : 2019-02-27 16:33:47 +0300
```
* Смотрим, что лежит на рабочем столе с расширением **.doc**: ```volatility -f 20190227.mem --profile=WinXPSP2x86 windows | grep .doc```:
```$
Volatility Foundation Volatility Framework 2.6
Window Handle: #5010c at 0xbc676728, Name: Секретно.doc - Microsoft Word
Window Handle: #20160 at 0xbc6781c8, Name: Секретно.doc
```
* Делаем dump файла к себе на машину ```volatility -f 20190227.mem --profile=WinXPSP2x86 dumpfiles -r Секретно.doc --name -D ./ -u``` 

И открываем полученный файл **file.1420.0x82237ba8.Секретно.doc.dat** 
# Задание 8
# Ответ на вопрос
# Задание 9
# Ответ на вопрос
# Задание 10
